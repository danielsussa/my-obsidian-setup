/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MyPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var dateRegex = new RegExp(/date: \d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])*/ig);
var tagRegex = new RegExp(new RegExp("(?<=[\\s>]|^)#(\\w*[A-Za-z_/-]+\\w*)", "ig"));
var DEFAULT_SETTINGS = {
  mySetting: "default"
};
var MyPlugin = class extends import_obsidian.Plugin {
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      const cached = yield this.loadCachedStruct();
      let modalSelector = new SelectorModal(this.app, cached);
      this.addCommand({
        id: "open-modal",
        name: "Open Tag Selector",
        checkCallback: (checking) => {
          if (!checking) {
            modalSelector.open();
          }
          return true;
        }
      });
      this.addSettingTab(new SampleSettingTab(this.app, this));
      this.registerEvent(this.app.metadataCache.on("changed", (file, data, cache) => {
        cached.setFileMap(file, cache, data);
      }));
      this.registerEvent(this.app.metadataCache.on("deleted", (file, data) => {
        cached.deleteFileMap(file);
      }));
    });
  }
  loadCachedStruct() {
    return __async(this, null, function* () {
      const { vault } = this.app;
      var cached = new CachedStruct();
      vault.getMarkdownFiles().map((file) => {
        vault.read(file).then((data) => {
          cached.setFileMap(file, this.app.metadataCache.getFileCache(file), data);
        });
      });
      return cached;
    });
  }
  onunload() {
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
};
var SELECTION_KIND = {
  ORPHAN: "orphan",
  METATAG: "metatag",
  CONTENT: "content"
};
var CachedStruct = class {
  constructor() {
    this.files = [];
  }
  deleteFileMap(file) {
    this.files = this.files.filter((x) => x.file != file);
  }
  setFileMap(file, cache, data) {
    var _a, _b, _c;
    this.deleteFileMap(file);
    let hasHeader = false;
    let selections = [];
    let pathTag = null;
    const pathSpl = file.path.split("/");
    if (pathSpl.length > 1) {
      pathTag = "#" + pathSpl[pathSpl.length - 2];
    }
    let headerTags = [];
    const date = (_b = (_a = data.match(dateRegex)) == null ? void 0 : _a.first()) == null ? void 0 : _b.substring(6);
    let contentData = data;
    if ((cache == null ? void 0 : cache.frontmatter) != null) {
      contentData = contentData.substring(cache.frontmatter.position.end.offset);
      contentData = contentData.trimStart();
      (_c = (0, import_obsidian.parseFrontMatterTags)(cache.frontmatter)) == null ? void 0 : _c.forEach((t) => headerTags.push(t));
      if (pathTag != null) {
        headerTags.push(pathTag);
      }
      if (date != null) {
        headerTags.push(date);
      }
    }
    if (headerTags.length > 0) {
      hasHeader = true;
      selections.push({
        cursor: 0,
        description: contentData.substring(0, 400),
        tags: headerTags.sort().filter(function(elem, index, self) {
          return index === self.indexOf(elem);
        })
      });
    }
    if ((cache == null ? void 0 : cache.tags) == null && headerTags.length == 0) {
      selections.push({
        cursor: 0,
        description: "",
        tags: []
      });
    }
    if ((cache == null ? void 0 : cache.tags) != null) {
      const dataSpl = data.split("\n");
      let offset = 0;
      for (let i = 0; i < dataSpl.length; i++) {
        const paragraph = dataSpl[i];
        const tagIdx = paragraph.search(tagRegex);
        if (tagIdx != -1) {
          const tags = [...paragraph.matchAll(tagRegex)].map((k) => k[0]).join().replace("/", ",").split(",");
          tags.push(...headerTags);
          selections.push({
            cursor: i,
            description: contentData.substring(offset + tagIdx - 200, offset + tagIdx + 200),
            tags: tags.sort().filter(function(elem, index, self) {
              return index === self.indexOf(elem);
            })
          });
        }
        offset += paragraph.length;
      }
    }
    this.files.push({
      fileTags: selections,
      file,
      date,
      hasHeader
    });
    this.files.sort((a, b) => {
      if (a.date == void 0) {
        return 1;
      }
      if (b.date == void 0) {
        return -1;
      }
      return a.date > b.date ? -1 : 1;
    });
  }
  search(query) {
    const getOrphan = query.startsWith("!");
    const getNoMd = query.startsWith("!!");
    let selections = [];
    let allTags = [];
    for (const file of this.files) {
      if (getNoMd && !file.hasHeader) {
        selections.push({
          path: file.file.path,
          file: file.file,
          hasHeader: false,
          kind: SELECTION_KIND.METATAG,
          cursor: 0,
          description: "",
          tags: []
        });
      }
      if (getOrphan && file.fileTags.length == 0) {
        selections.push({
          path: file.file.path,
          file: file.file,
          hasHeader: false,
          kind: SELECTION_KIND.ORPHAN,
          cursor: 0,
          description: "",
          tags: []
        });
      }
      let isFirst = true;
      for (const fileTag of file.fileTags) {
        let toSelection = true;
        for (const subQuery of query.split(" ")) {
          const tagsJoin = fileTag.tags.join();
          if (!tagsJoin.contains(subQuery)) {
            toSelection = false;
            break;
          }
        }
        if (toSelection) {
          let kind = SELECTION_KIND.CONTENT;
          if (isFirst) {
            kind = SELECTION_KIND.METATAG;
          }
          isFirst = false;
          selections.push({
            hasHeader: file.hasHeader,
            file: file.file,
            path: file.file.path,
            kind,
            cursor: fileTag.cursor,
            description: fileTag.description,
            tags: fileTag.tags
          });
          allTags.push(...fileTag.tags);
        }
      }
    }
    return {
      selections,
      tags: allTags.unique()
    };
  }
  getAll() {
    return this.files;
  }
};
var SelectorModal = class extends import_obsidian.SuggestModal {
  constructor(app2, cache) {
    super(app2);
    this.cached = cache;
    this.setInstructions([
      { command: "\u2191\u2193", purpose: "to navidate" },
      { command: "\u21B5", purpose: "to open" },
      { command: "esc", purpose: "to dismiss" }
    ]);
    this.modalEl.style.setProperty("max-width", "90vw");
    this.modalEl.style.setProperty("width", "100%");
    this.modalEl.style.setProperty("max-height", "80vh");
    this.modalEl.style.setProperty("height", "100%");
    this.setPlaceholder("Type one tag or multiple (eg.: tag1 tag2)");
    this.limit = 20;
    this.tagContainer = this.modalEl.createEl("p");
    this.tagContainer.insertAfter(this.inputEl);
  }
  getSuggestions(query) {
    const container = this.cached.search(query);
    this.renderTags(container.tags);
    return container.selections;
  }
  renderSuggestion(value, el) {
    if (value.kind == SELECTION_KIND.CONTENT) {
      const selection = el.createEl("div", { cls: "selection-content" });
      const title = selection.createEl("div", { cls: "selection__title" });
      const tagContainer = title.createEl("span", { text: " " });
      for (let i = 0; i < value.tags.length; i++) {
        tagContainer.createEl("a", { text: value.tags[i], cls: "tag selection__tag" });
      }
      selection.createEl("small", { text: value.description, cls: "selection__description" });
    } else if (value.kind == SELECTION_KIND.ORPHAN) {
      const selection = el.createEl("div", { cls: "selection" });
      selection.createEl("div", { text: value.path, cls: "selection__title_bad" });
    } else if (value.kind == SELECTION_KIND.METATAG) {
      const selection = el.createEl("div", { cls: "selection" });
      const title = selection.createEl("div", { text: value.path, cls: "selection__title" });
      const tagContainer = title.createEl("span", { text: " " });
      for (let i = 0; i < value.tags.length; i++) {
        tagContainer.createEl("a", { text: value.tags[i], cls: "tag selection__tag" });
      }
      title.createEl("small", { text: !value.hasHeader ? " \u2192 (miss metadata)" : "", cls: "selection__title_bad" });
      selection.createEl("small", { text: value.description, cls: "selection__description" });
    }
  }
  onChooseSuggestion(item, evt) {
    const leaf = app.workspace.getLeaf(false);
    leaf.openFile(item.file).then(() => {
      var _a;
      if (((_a = leaf.view) == null ? void 0 : _a.getViewType()) === "markdown") {
        const md = leaf.view;
        md.editor.setCursor(item.cursor);
        const ep = md.editor.getCursor();
        md.editor.scrollIntoView({ from: ep, to: ep }, true);
      }
    });
  }
  renderTags(tags) {
    this.tagContainer.empty();
    for (const tag of tags.splice(0, 20)) {
      this.tagContainer.createEl("a", { text: tag, cls: "tag selection__tag" });
    }
  }
  onOpen() {
    const container = this.cached.search("");
    this.renderTags(container.tags);
    for (const sugestion of container.selections) {
      this.renderSuggestion(sugestion, this.resultContainerEl);
    }
    super.onOpen();
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  open() {
    super.open();
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Settings for my awesome plugin." });
    new import_obsidian.Setting(containerEl).setName("My setting").setDesc("It's a secret").addText((text) => text.setPlaceholder("Enter your secret").setValue(this.plugin.settings.mySetting).onChange((value) => __async(this, null, function* () {
      console.log("Secret: " + value);
      this.plugin.settings.mySetting = value;
      yield this.plugin.saveSettings();
    })));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBDYWNoZWRNZXRhZGF0YSwgRWRpdG9yLCBnZXRBbGxUYWdzLCBNYXJrZG93blZpZXcsIE1ldGFkYXRhQ2FjaGUsIE1vZGFsLCBOb3RpY2UsIHBhcnNlRnJvbnRNYXR0ZXJUYWdzLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFN1Z2dlc3RNb2RhbCwgVGFnQ2FjaGUsIFRGaWxlLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcblxuXG4vLyBSZW1lbWJlciB0byByZW5hbWUgdGhlc2UgY2xhc3NlcyBhbmQgaW50ZXJmYWNlcyFcblxuY29uc3QgZGF0ZVJlZ2V4ID0gbmV3IFJlZ0V4cCgvZGF0ZTogXFxkezR9XFwtKDA/WzEtOV18MVswMTJdKVxcLSgwP1sxLTldfFsxMl1bMC05XXwzWzAxXSkqL2lnKTtcbmNvbnN0IHRhZ1JlZ2V4ID0gbmV3IFJlZ0V4cCgvKD88PVtcXHM+XXxeKSMoXFx3KltBLVphLXpfLy1dK1xcdyopL2lnKTtcblxuaW50ZXJmYWNlIE15UGx1Z2luU2V0dGluZ3Mge1xuXHRteVNldHRpbmc6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTXlQbHVnaW5TZXR0aW5ncyA9IHtcblx0bXlTZXR0aW5nOiAnZGVmYXVsdCdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXlQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRzZXR0aW5nczogTXlQbHVnaW5TZXR0aW5ncztcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdGNvbnN0IGNhY2hlZCA9IGF3YWl0IHRoaXMubG9hZENhY2hlZFN0cnVjdCgpO1xuXHRcdGxldCBtb2RhbFNlbGVjdG9yID0gbmV3IFNlbGVjdG9yTW9kYWwodGhpcy5hcHAsIGNhY2hlZClcblxuXHRcdC8vIFRoaXMgYWRkcyBhIGNvbXBsZXggY29tbWFuZCB0aGF0IGNhbiBjaGVjayB3aGV0aGVyIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBhcHAgYWxsb3dzIGV4ZWN1dGlvbiBvZiB0aGUgY29tbWFuZFxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ29wZW4tbW9kYWwnLFxuXHRcdFx0bmFtZTogJ09wZW4gVGFnIFNlbGVjdG9yJyxcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXG5cdFx0XHRcdGlmICghY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRtb2RhbFNlbGVjdG9yLm9wZW4oKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBUaGlzIGNvbW1hbmQgd2lsbCBvbmx5IHNob3cgdXAgaW4gQ29tbWFuZCBQYWxldHRlIHdoZW4gdGhlIGNoZWNrIGZ1bmN0aW9uIHJldHVybnMgdHJ1ZVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc2V0dGluZ3MgdGFiIHNvIHRoZSB1c2VyIGNhbiBjb25maWd1cmUgdmFyaW91cyBhc3BlY3RzIG9mIHRoZSBwbHVnaW5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNhbXBsZVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgKGZpbGUsIGRhdGEsIGNhY2hlKSA9PiB7XG5cdFx0XHRjYWNoZWQuc2V0RmlsZU1hcChmaWxlLCBjYWNoZSwgZGF0YSlcblx0XHR9KSk7XG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2RlbGV0ZWQnLCAoZmlsZSwgZGF0YSkgPT4ge1xuXHRcdFx0Y2FjaGVkLmRlbGV0ZUZpbGVNYXAoZmlsZSlcblx0XHR9KSk7XG5cblx0fVxuXG5cdGFzeW5jIGxvYWRDYWNoZWRTdHJ1Y3QoKTogUHJvbWlzZTxDYWNoZWRTdHJ1Y3Q+IHtcblx0XHRjb25zdCB7IHZhdWx0IH0gPSB0aGlzLmFwcDtcblxuXHRcdHZhciBjYWNoZWQgPSBuZXcgQ2FjaGVkU3RydWN0KClcblx0XHR2YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkubWFwKChmaWxlKSA9PiB7XG5cdFx0XHR2YXVsdC5yZWFkKGZpbGUpLnRoZW4oKGRhdGEpID0+IHtcblx0XHRcdFx0Y2FjaGVkLnNldEZpbGVNYXAoZmlsZSwgdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSksIGRhdGEpXG5cdFx0XHR9KTtcblx0XHR9KVxuXHRcdHJldHVybiBjYWNoZWQ7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblxuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cbn1cblxuY29uc3QgU0VMRUNUSU9OX0tJTkQgPSB7XG5cdE9SUEhBTjogJ29ycGhhbicsXG5cdE1FVEFUQUc6ICdtZXRhdGFnJyxcblx0Q09OVEVOVDogJ2NvbnRlbnQnLFxufVxuXG5jbGFzcyBDYWNoZWRTdHJ1Y3Qge1xuXHRmaWxlczogRmlsZVtdXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHRoaXMuZmlsZXMgPSBbXVxuXHR9XG5cblx0ZGVsZXRlRmlsZU1hcChmaWxlOiBURmlsZSkge1xuXHRcdHRoaXMuZmlsZXMgPSB0aGlzLmZpbGVzLmZpbHRlcih4ID0+IHguZmlsZSAhPSBmaWxlKVxuXHR9XG5cblx0c2V0RmlsZU1hcChmaWxlOiBURmlsZSwgY2FjaGU6IENhY2hlZE1ldGFkYXRhIHwgbnVsbCwgZGF0YTogc3RyaW5nKSB7XG5cdFx0dGhpcy5kZWxldGVGaWxlTWFwKGZpbGUpXG5cblx0XHRsZXQgaGFzSGVhZGVyID0gZmFsc2Vcblx0XHRsZXQgc2VsZWN0aW9uczogQXJyYXk8RmlsZVRhZz4gPSBbXVxuXG5cdFx0bGV0IHBhdGhUYWc6IHN0cmluZ3xudWxsID0gbnVsbFxuXHRcdGNvbnN0IHBhdGhTcGwgPSBmaWxlLnBhdGguc3BsaXQoXCIvXCIpIFxuXHRcdGlmIChwYXRoU3BsLmxlbmd0aCA+IDEpIHtcblx0XHRcdHBhdGhUYWcgPSBcIiNcIiArIHBhdGhTcGxbcGF0aFNwbC5sZW5ndGgtMl1cblx0XHR9XG5cblx0XHRsZXQgaGVhZGVyVGFnczogQXJyYXk8c3RyaW5nPiA9IFtdXG5cblx0XHRjb25zdCBkYXRlID0gZGF0YS5tYXRjaChkYXRlUmVnZXgpPy5maXJzdCgpPy5zdWJzdHJpbmcoNilcblx0XHRcblxuXHRcdGxldCBjb250ZW50RGF0YSA9IGRhdGFcblx0XHQvLyBpZiBoYXMgaGVhZGVyIHRhZ1xuXHRcdGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIgIT0gbnVsbCkge1xuXHRcdFx0Y29udGVudERhdGEgPSBjb250ZW50RGF0YS5zdWJzdHJpbmcoY2FjaGUuZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLm9mZnNldClcblx0XHRcdGNvbnRlbnREYXRhID0gY29udGVudERhdGEudHJpbVN0YXJ0KClcblx0XG5cdFx0XHRwYXJzZUZyb250TWF0dGVyVGFncyhjYWNoZS5mcm9udG1hdHRlcik/LmZvckVhY2godCA9PiBoZWFkZXJUYWdzLnB1c2godCkpXG5cdFx0XHRpZiAocGF0aFRhZyAhPSBudWxsKSB7XG5cdFx0XHRcdGhlYWRlclRhZ3MucHVzaChwYXRoVGFnKVxuXHRcdFx0fVxuXHRcdFx0aWYgKGRhdGUgIT0gbnVsbCkge1xuXHRcdFx0XHRoZWFkZXJUYWdzLnB1c2goZGF0ZSlcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBwdXNoIGhlYWRlciB0YWdcblx0XHRpZiAoaGVhZGVyVGFncy5sZW5ndGggPiAwKSB7XG5cdFx0XHRoYXNIZWFkZXIgPSB0cnVlXG5cdFx0XHRzZWxlY3Rpb25zLnB1c2goe1xuXHRcdFx0XHRjdXJzb3I6IDAsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiBjb250ZW50RGF0YS5zdWJzdHJpbmcoMCw0MDApLFxuXHRcdFx0XHR0YWdzOiBoZWFkZXJUYWdzLnNvcnQoKS5maWx0ZXIoZnVuY3Rpb24oZWxlbSwgaW5kZXgsIHNlbGYpIHtcblx0XHRcdFx0XHRyZXR1cm4gaW5kZXggPT09IHNlbGYuaW5kZXhPZihlbGVtKTtcblx0XHRcdFx0fSksXG5cdFx0XHR9KVxuXHRcdH1cblxuXG5cdFx0Ly8gbm8gdGFncyBhbmQgbm8gaGVhZGVyIHRhZ3Ncblx0XHRpZiAoY2FjaGU/LnRhZ3MgPT0gbnVsbCAmJiBoZWFkZXJUYWdzLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRzZWxlY3Rpb25zLnB1c2goe1xuXHRcdFx0XHRjdXJzb3I6IDAsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiBcIlwiLFxuXHRcdFx0XHR0YWdzOiBbXSxcblx0XHRcdH0pXG5cdFx0fVxuXHRcdFxuXG5cdFx0aWYgKGNhY2hlPy50YWdzICE9IG51bGwpIHtcblx0XHRcdGNvbnN0IGRhdGFTcGwgPSBkYXRhLnNwbGl0KFwiXFxuXCIpXG5cdFx0XHRsZXQgb2Zmc2V0ID0gMDtcblx0XHRcdGZvciAobGV0IGkgPSAwIDsgaSA8IGRhdGFTcGwubGVuZ3RoIDsgaSsrKXtcblx0XHRcdFx0Y29uc3QgcGFyYWdyYXBoID0gZGF0YVNwbFtpXVxuXHRcdFx0XHRjb25zdCB0YWdJZHggPSBwYXJhZ3JhcGguc2VhcmNoKHRhZ1JlZ2V4KVxuXHRcdFxuXHRcdFx0XHRpZiAodGFnSWR4ICE9IC0xKSB7XG5cdFx0XHRcdFx0Y29uc3QgdGFncyA9IFsuLi5wYXJhZ3JhcGgubWF0Y2hBbGwodGFnUmVnZXgpXS5tYXAoayA9PiBrWzBdKS5qb2luKCkucmVwbGFjZShcIi9cIixcIixcIikuc3BsaXQoXCIsXCIpO1xuXHRcdFx0XHRcdHRhZ3MucHVzaCguLi5oZWFkZXJUYWdzKVxuXHRcdFx0XHRcdHNlbGVjdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0XHRjdXJzb3I6IGksXG5cdFx0XHRcdFx0XHRkZXNjcmlwdGlvbjogY29udGVudERhdGEuc3Vic3RyaW5nKG9mZnNldCt0YWdJZHgtMjAwLCBvZmZzZXQrdGFnSWR4KzIwMCksXG5cdFx0XHRcdFx0XHR0YWdzOiB0YWdzLnNvcnQoKS5maWx0ZXIoZnVuY3Rpb24oZWxlbSwgaW5kZXgsIHNlbGYpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGluZGV4ID09PSBzZWxmLmluZGV4T2YoZWxlbSk7XG5cdFx0XHRcdFx0XHR9KSxcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdG9mZnNldCArPSBwYXJhZ3JhcGgubGVuZ3RoXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5maWxlcy5wdXNoKHtcblx0XHRcdGZpbGVUYWdzOiBzZWxlY3Rpb25zLFxuXHRcdFx0ZmlsZTogZmlsZSxcblx0XHRcdGRhdGU6IGRhdGUsXG5cdFx0XHRoYXNIZWFkZXI6IGhhc0hlYWRlclxuXHRcdH0pXG5cdFx0dGhpcy5maWxlcy5zb3J0KChhLGIpID0+IHtcblx0XHRcdGlmIChhLmRhdGUgPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHJldHVybiAxXG5cdFx0XHR9XG5cdFx0XHRpZiAoYi5kYXRlID09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRyZXR1cm4gLTFcblx0XHRcdH1cblx0XHRcdHJldHVybiBhLmRhdGUgPiBiLmRhdGUgPyAtMSA6IDE7XG5cdFx0fSlcblx0fVxuXG5cblx0c2VhcmNoKHF1ZXJ5OiBzdHJpbmcpOiBTZWxlY3Rpb25Db250YWluZXIge1xuXHRcdGNvbnN0IGdldE9ycGhhbiA9IHF1ZXJ5LnN0YXJ0c1dpdGgoXCIhXCIpXG5cdFx0Y29uc3QgZ2V0Tm9NZCA9IHF1ZXJ5LnN0YXJ0c1dpdGgoXCIhIVwiKVxuXHRcdGxldCBzZWxlY3Rpb25zOiBBcnJheTxTZWxlY3Rpb24+ID0gW11cblx0XHRsZXQgYWxsVGFnczogQXJyYXk8c3RyaW5nPiA9IFtdXG5cblx0XHRmb3IgKGNvbnN0IGZpbGUgb2YgdGhpcy5maWxlcykge1xuXHRcdFx0aWYgKGdldE5vTWQgJiYgIWZpbGUuaGFzSGVhZGVyKSB7XG5cdFx0XHRcdHNlbGVjdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0cGF0aDogZmlsZS5maWxlLnBhdGgsXG5cdFx0XHRcdFx0ZmlsZTogZmlsZS5maWxlLFxuXHRcdFx0XHRcdGhhc0hlYWRlcjogZmFsc2UsXG5cdFx0XHRcdFx0a2luZDogU0VMRUNUSU9OX0tJTkQuTUVUQVRBRyxcblx0XHRcdFx0XHRjdXJzb3I6IDAsXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IFwiXCIsXG5cdFx0XHRcdFx0dGFnczogW11cblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHRcdGlmIChnZXRPcnBoYW4gJiYgZmlsZS5maWxlVGFncy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHRzZWxlY3Rpb25zLnB1c2goe1xuXHRcdFx0XHRcdHBhdGg6IGZpbGUuZmlsZS5wYXRoLFxuXHRcdFx0XHRcdGZpbGU6IGZpbGUuZmlsZSxcblx0XHRcdFx0XHRoYXNIZWFkZXI6IGZhbHNlLFxuXHRcdFx0XHRcdGtpbmQ6IFNFTEVDVElPTl9LSU5ELk9SUEhBTixcblx0XHRcdFx0XHRjdXJzb3I6IDAsXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IFwiXCIsXG5cdFx0XHRcdFx0dGFnczogW11cblx0XHRcdFx0fSlcblx0XHRcdH1cblxuXHRcdFx0bGV0IGlzRmlyc3QgPSB0cnVlXG5cdFx0XHRmb3IgKGNvbnN0IGZpbGVUYWcgb2YgZmlsZS5maWxlVGFncykge1xuXHRcdFx0XHRsZXQgdG9TZWxlY3Rpb24gPSB0cnVlXG5cdFx0XHRcdGZvciAoY29uc3Qgc3ViUXVlcnkgb2YgcXVlcnkuc3BsaXQoXCIgXCIpKSB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29uc3QgdGFnc0pvaW4gPSBmaWxlVGFnLnRhZ3Muam9pbigpXG5cdFx0XHRcdFx0aWYgKCF0YWdzSm9pbi5jb250YWlucyhzdWJRdWVyeSkpIHtcblx0XHRcdFx0XHRcdHRvU2VsZWN0aW9uID0gZmFsc2Vcblx0XHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodG9TZWxlY3Rpb24pIHtcblx0XHRcdFx0XHRsZXQga2luZCA9IFNFTEVDVElPTl9LSU5ELkNPTlRFTlRcblx0XHRcdFx0XHRpZiAoaXNGaXJzdCkge1xuXHRcdFx0XHRcdFx0a2luZCA9IFNFTEVDVElPTl9LSU5ELk1FVEFUQUdcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpc0ZpcnN0ID0gZmFsc2Vcblx0XHRcdFx0XHRzZWxlY3Rpb25zLnB1c2goe1xuXHRcdFx0XHRcdFx0aGFzSGVhZGVyOiBmaWxlLmhhc0hlYWRlcixcblx0XHRcdFx0XHRcdGZpbGU6IGZpbGUuZmlsZSxcblx0XHRcdFx0XHRcdHBhdGg6IGZpbGUuZmlsZS5wYXRoLFxuXHRcdFx0XHRcdFx0a2luZDoga2luZCxcblx0XHRcdFx0XHRcdGN1cnNvcjogZmlsZVRhZy5jdXJzb3IsXG5cdFx0XHRcdFx0XHRkZXNjcmlwdGlvbjogZmlsZVRhZy5kZXNjcmlwdGlvbixcblx0XHRcdFx0XHRcdHRhZ3M6IGZpbGVUYWcudGFnc1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0YWxsVGFncy5wdXNoKC4uLmZpbGVUYWcudGFncylcblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHRzZWxlY3Rpb25zOiBzZWxlY3Rpb25zLFxuXHRcdFx0dGFnczogYWxsVGFncy51bmlxdWUoKVxuXHRcdH1cblx0fVxuXG5cdGdldEFsbCgpOiBGaWxlW10ge1xuXHRcdHJldHVybiB0aGlzLmZpbGVzXG5cdH1cbn1cblxuaW50ZXJmYWNlIEZpbGUge1xuXHRoYXNIZWFkZXI6IGJvb2xlYW47XG5cdGZpbGU6IFRGaWxlO1xuXHRkYXRlOiBzdHJpbmd8dW5kZWZpbmVkO1xuXHRmaWxlVGFnczogRmlsZVRhZ1tdXG59XG5cbmludGVyZmFjZSBGaWxlVGFnIHtcblx0Y3Vyc29yOiBudW1iZXI7XG5cdGRlc2NyaXB0aW9uOiBzdHJpbmc7XG5cdHRhZ3M6IHN0cmluZ1tdO1xufVxuXG5pbnRlcmZhY2UgU2VsZWN0aW9uQ29udGFpbmVyIHtcblx0c2VsZWN0aW9uczogU2VsZWN0aW9uW11cblx0dGFnczogc3RyaW5nW11cbn1cblxuaW50ZXJmYWNlIFNlbGVjdGlvbiB7XG5cdGhhc0hlYWRlcjogYm9vbGVhblxuXHRmaWxlOiBURmlsZTtcblx0a2luZDogc3RyaW5nO1xuXHRwYXRoOiBzdHJpbmc7XG5cdGN1cnNvcjogbnVtYmVyO1xuXHRkZXNjcmlwdGlvbjogc3RyaW5nO1xuXHR0YWdzOiBzdHJpbmdbXTtcbn1cblxuY2xhc3MgU2VsZWN0b3JNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxTZWxlY3Rpb24+IHtcblxuXHRjYWNoZWQ6IENhY2hlZFN0cnVjdDtcblx0dGFnQ29udGFpbmVyOiBIVE1MUGFyYWdyYXBoRWxlbWVudFxuXG5cdGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBTZWxlY3Rpb25bXSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jYWNoZWQuc2VhcmNoKHF1ZXJ5KVxuXHRcdHRoaXMucmVuZGVyVGFncyhjb250YWluZXIudGFncylcblx0XHRyZXR1cm4gY29udGFpbmVyLnNlbGVjdGlvbnNcblx0fVxuXG5cdHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IFNlbGVjdGlvbiwgZWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0aWYgKHZhbHVlLmtpbmQgPT0gU0VMRUNUSU9OX0tJTkQuQ09OVEVOVCkge1xuXHRcdFx0Y29uc3Qgc2VsZWN0aW9uID0gZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2VsZWN0aW9uLWNvbnRlbnRcIiB9KTtcblxuXHRcdFx0Y29uc3QgdGl0bGUgPSBzZWxlY3Rpb24uY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2VsZWN0aW9uX190aXRsZVwiIH0pO1xuXG5cdFx0XHRjb25zdCB0YWdDb250YWluZXIgPSB0aXRsZS5jcmVhdGVFbChcInNwYW5cIiwge3RleHQ6XCIgXCJ9KVxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS50YWdzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhZ0NvbnRhaW5lci5jcmVhdGVFbChcImFcIiwgeyB0ZXh0OiB2YWx1ZS50YWdzW2ldLCBjbHM6IFwidGFnIHNlbGVjdGlvbl9fdGFnXCIgfSk7XG5cdFx0XHR9XG5cblx0XHRcdHNlbGVjdGlvbi5jcmVhdGVFbChcInNtYWxsXCIsIHsgdGV4dDogdmFsdWUuZGVzY3JpcHRpb24sIGNsczogXCJzZWxlY3Rpb25fX2Rlc2NyaXB0aW9uXCIgfSk7XG5cblx0XHR9ZWxzZSBpZiAodmFsdWUua2luZCA9PSBTRUxFQ1RJT05fS0lORC5PUlBIQU4pIHtcblx0XHRcdGNvbnN0IHNlbGVjdGlvbiA9IGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNlbGVjdGlvblwiIH0pO1xuXHRcdFx0c2VsZWN0aW9uLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogdmFsdWUucGF0aCwgY2xzOiBcInNlbGVjdGlvbl9fdGl0bGVfYmFkXCIgfSk7XG5cdFx0fWVsc2UgaWYgKHZhbHVlLmtpbmQgPT0gU0VMRUNUSU9OX0tJTkQuTUVUQVRBRykge1xuXHRcdFx0Y29uc3Qgc2VsZWN0aW9uID0gZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2VsZWN0aW9uXCIgfSk7XG5cdFx0XHRjb25zdCB0aXRsZSA9IHNlbGVjdGlvbi5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IHZhbHVlLnBhdGgsIGNsczogXCJzZWxlY3Rpb25fX3RpdGxlXCIgfSk7XG5cblx0XHRcdGNvbnN0IHRhZ0NvbnRhaW5lciA9IHRpdGxlLmNyZWF0ZUVsKFwic3BhblwiLCB7dGV4dDpcIiBcIn0pXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLnRhZ3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFnQ29udGFpbmVyLmNyZWF0ZUVsKFwiYVwiLCB7IHRleHQ6IHZhbHVlLnRhZ3NbaV0sIGNsczogXCJ0YWcgc2VsZWN0aW9uX190YWdcIiB9KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGl0bGUuY3JlYXRlRWwoXCJzbWFsbFwiLCB7IHRleHQ6ICF2YWx1ZS5oYXNIZWFkZXIgPyAnIFx1MjE5MiAobWlzcyBtZXRhZGF0YSknOiAnJywgY2xzOiBcInNlbGVjdGlvbl9fdGl0bGVfYmFkXCIgfSk7XG5cdFx0XHRzZWxlY3Rpb24uY3JlYXRlRWwoXCJzbWFsbFwiLCB7IHRleHQ6IHZhbHVlLmRlc2NyaXB0aW9uLCBjbHM6IFwic2VsZWN0aW9uX19kZXNjcmlwdGlvblwiIH0pO1xuXHRcblxuXG5cdFx0fVxuXG5cdH1cblxuXHRvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogU2VsZWN0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG5cdFx0Y29uc3QgbGVhZiA9IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSlcblx0XHRsZWFmLm9wZW5GaWxlKGl0ZW0uZmlsZSkudGhlbigoKSA9PiB7XG5cdFx0XHRpZiAobGVhZi52aWV3Py5nZXRWaWV3VHlwZSgpID09PSAnbWFya2Rvd24nKSB7XG5cdFx0XHRcdGNvbnN0IG1kID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0bWQuZWRpdG9yLnNldEN1cnNvcihpdGVtLmN1cnNvcilcblx0XHRcdFx0Y29uc3QgZXAgPSBtZC5lZGl0b3IuZ2V0Q3Vyc29yKClcblx0XHRcdFx0bWQuZWRpdG9yLnNjcm9sbEludG9WaWV3KHtmcm9tOiBlcCwgdG86IGVwfSwgdHJ1ZSlcblx0XHRcdH1cblx0XHR9KVxuXHRcdFxuXHR9XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGNhY2hlOiBDYWNoZWRTdHJ1Y3QpIHtcblx0XHRzdXBlcihhcHApO1xuXHRcdFx0XHRcblx0XHR0aGlzLmNhY2hlZCA9IGNhY2hlXG5cdFx0dGhpcy5zZXRJbnN0cnVjdGlvbnMoW1xuXHRcdFx0e2NvbW1hbmQ6IFwiXHUyMTkxXHUyMTkzXCIsIHB1cnBvc2U6IFwidG8gbmF2aWRhdGVcIn0sXG5cdFx0XHR7Y29tbWFuZDogXCJcdTIxQjVcIiwgcHVycG9zZTogXCJ0byBvcGVuXCJ9LFxuXHRcdFx0e2NvbW1hbmQ6IFwiZXNjXCIsIHB1cnBvc2U6IFwidG8gZGlzbWlzc1wifVxuXHRcdF0pXG5cdFx0dGhpcy5tb2RhbEVsLnN0eWxlLnNldFByb3BlcnR5KFwibWF4LXdpZHRoXCIsIFwiOTB2d1wiKVxuXHRcdHRoaXMubW9kYWxFbC5zdHlsZS5zZXRQcm9wZXJ0eShcIndpZHRoXCIsIFwiMTAwJVwiKVxuXHRcdHRoaXMubW9kYWxFbC5zdHlsZS5zZXRQcm9wZXJ0eShcIm1heC1oZWlnaHRcIiwgXCI4MHZoXCIpXG5cdFx0dGhpcy5tb2RhbEVsLnN0eWxlLnNldFByb3BlcnR5KFwiaGVpZ2h0XCIsIFwiMTAwJVwiKVxuXG5cdFx0dGhpcy5zZXRQbGFjZWhvbGRlcihcIlR5cGUgb25lIHRhZyBvciBtdWx0aXBsZSAoZWcuOiB0YWcxIHRhZzIpXCIpXG5cdFx0dGhpcy5saW1pdCA9IDIwXG5cblxuXHRcdC8vIGNvbnN0IHJlcyA9IGNhY2hlZC50b1NlbGVjdGlvbnMoKVxuXHRcdC8vIHRoaXMuYWxsUmVzdWx0cyA9IHJlcztcblx0XHQvLyB0aGlzLmFsbFRhZ3MgPSByZXMubWFwKGsgPT4gay50YWdzKS5qb2luKCkuc3BsaXQoXCIsXCIpLnVuaXF1ZSgpO1xuXHRcdC8vIHRoaXMuc2VsZWN0ZWRUYWdzID0gcmVzLm1hcChrID0+IGsudGFncykuam9pbigpLnNwbGl0KFwiLFwiKS51bmlxdWUoKTtcblxuXHRcdFxuXG5cdFx0dGhpcy50YWdDb250YWluZXIgPSB0aGlzLm1vZGFsRWwuY3JlYXRlRWwoXCJwXCIpXG5cdFx0dGhpcy50YWdDb250YWluZXIuaW5zZXJ0QWZ0ZXIodGhpcy5pbnB1dEVsKVxuXHRcdFxuXG5cdH1cblxuXHRyZW5kZXJUYWdzKHRhZ3M6IHN0cmluZ1tdKSB7XG5cdFx0dGhpcy50YWdDb250YWluZXIuZW1wdHkoKVxuXHRcdGZvciAoY29uc3QgdGFnIG9mIHRhZ3Muc3BsaWNlKDAsMjApKSB7XG5cdFx0XHR0aGlzLnRhZ0NvbnRhaW5lci5jcmVhdGVFbChcImFcIiwgeyB0ZXh0OiB0YWcsIGNsczogXCJ0YWcgc2VsZWN0aW9uX190YWdcIiB9KTtcblx0XHR9XG5cdH1cblxuXHRvbk9wZW4oKTogdm9pZCB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jYWNoZWQuc2VhcmNoKFwiXCIpXG5cdFx0dGhpcy5yZW5kZXJUYWdzKGNvbnRhaW5lci50YWdzKVxuXG5cdFx0Zm9yIChjb25zdCBzdWdlc3Rpb24gb2YgY29udGFpbmVyLnNlbGVjdGlvbnMpIHtcblx0XHRcdHRoaXMucmVuZGVyU3VnZ2VzdGlvbihzdWdlc3Rpb24sIHRoaXMucmVzdWx0Q29udGFpbmVyRWwpXG5cdFx0fVxuXHRcdHN1cGVyLm9uT3BlbigpXG5cdFxuXHR9XG5cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHtjb250ZW50RWx9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxuXG5cdG9wZW4oKTogdm9pZCB7XG5cdFx0c3VwZXIub3BlbigpXG5cdH1cbn1cblxuY2xhc3MgU2FtcGxlU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IE15UGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE15UGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1NldHRpbmdzIGZvciBteSBhd2Vzb21lIHBsdWdpbi4nfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdNeSBzZXR0aW5nJylcblx0XHRcdC5zZXREZXNjKCdJdFxcJ3MgYSBzZWNyZXQnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignRW50ZXIgeW91ciBzZWNyZXQnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubXlTZXR0aW5nKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ1NlY3JldDogJyArIHZhbHVlKTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5teVNldHRpbmcgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBbU07QUFLbk0sSUFBTSxZQUFZLElBQUksT0FBTyw2REFBNkQ7QUFDMUYsSUFBTSxXQUFXLElBQUksT0FBTyxXQUFDLHdDQUFrQyxJQUFFO0FBTWpFLElBQU0sbUJBQXFDO0FBQUEsRUFDMUMsV0FBVztBQUNaO0FBRUEsSUFBcUIsV0FBckIsY0FBc0MsdUJBQU87QUFBQSxFQUc1QyxBQUFNLFNBQVM7QUFBQTtBQUNkLFlBQU0sS0FBSyxhQUFhO0FBRXhCLFlBQU0sU0FBUyxNQUFNLEtBQUssaUJBQWlCO0FBQzNDLFVBQUksZ0JBQWdCLElBQUksY0FBYyxLQUFLLEtBQUssTUFBTTtBQUd0RCxXQUFLLFdBQVc7QUFBQSxRQUNmLElBQUk7QUFBQSxRQUNKLE1BQU07QUFBQSxRQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQUVyQyxjQUFJLENBQUMsVUFBVTtBQUNkLDBCQUFjLEtBQUs7QUFBQSxVQUNw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
